	--获取场景中物体所用的所有材质
	--这些材质应当少于scenematerials
	fn GetAllMatUsedByScene = 
	(
		allmats=#()
		max select all
		for obj in Selection do (
			if obj.material!=undefined then (
				append allmats obj.material
				if classof obj.material==Multimaterial then (
					for x in obj.material.materialList do (
						if x!=undefined then
							append allmats x
					)
				)
			)
		)
		max select none
		return allmats
	)
	
	
	fn CollectSubMats mat mats = 
	(
		if ( classof mat  == Multimaterial) then 
		(
			for i=1 to mat.numsubs do 
			(
				CollectSubMats mat[i] mats
			)
		 )
		 else if(classof mat == standard) then 
		 (
			 append  mats mat
		 )
		 else
		 (
		     messagebox ("出现了不是多维材质或者标准材质的材质"+mat.name)
		 )
	)
	
	--这里收集场景中的所有子材质
	fn collectAllSubMats = (
		allSubMats=#()
		for mat in scenematerials do 
		(
		   CollectSubMats mat allsubMats
		)
		
		return allSubMats
	)
	